{
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "SnykCode",
          "semanticVersion": "1.0.0",
          "version": "1.0.0",
          "rules": [
            {
              "id": "cpp/BufferOverflow",
              "name": "BufferOverflow",
              "shortDescription": {
                "text": "Buffer Overflow"
              },
              "defaultConfiguration": {
                "level": "warning"
              },
              "help": {
                "markdown": "\n## Details\n\nA buffer overflow is a type of runtime error that allows a program to write past the end of a buffer or array — hence the name overflow — and corrupt adjacent memory. Like most bugs, a buffer overflow doesn’t manifest at every program execution. Instead, the vulnerability is triggered under certain circumstances, such as unexpected user input.\n\nA buffer overflow attack is the exploitation of a buffer overflow vulnerability — typically by a malicious actor who wants to gain access or information. In this post, we’ll explain how a buffer overflow occurs and show you how to protect your C++ code from these attacks. Buffer overflows generally result in program crashes, however if the data that would overflow is user controlled, an attacker may cause more damage including deny of service attacks, infinite loops, or even remote code execution.",
                "text": ""
              },
              "properties": {
                "tags": [
                  "cpp",
                  "BufferOverflow",
                  "Security",
                  "SourceResourceAccess",
                  "SourceFile",
                  "Taint"
                ],
                "categories": [
                  "Security"
                ],
                "exampleCommitFixes": [
                  {
                    "commitURL": "https://github.com/Enlightenment/enlightenment/commit/252198488c727aab2d859f57ca50be20e8af5e2f?diff=split#diff-78a11a64617d2558c9ef1c7ff2fb84a224428b4c039d997dce0183db34848171L-1",
                    "lines": [
                      {
                        "line": "strcpy(lower_language, language);\n",
                        "lineNumber": 548,
                        "lineChange": "removed"
                      },
                      {
                        "line": "strncpy(lower_language, language, sizeof(lower_language) - 1);\n",
                        "lineNumber": 548,
                        "lineChange": "added"
                      },
                      {
                        "line": "lower_language[sizeof(lower_language) - 1] = '\\0';\n",
                        "lineNumber": 549,
                        "lineChange": "added"
                      }
                    ]
                  },
                  {
                    "commitURL": "https://github.com/cyrusimap/cyrus-imapd/commit/68b9316ec9581884bd10083e18204a8c9f69a054?diff=split#diff-657b78f1c46decb566e79bfd864154a2e21846e2a35e3199dd65b65c65971deeL-1",
                    "lines": [
                      {
                        "line": "strcpy(buf, argv[i]);\n",
                        "lineNumber": 195,
                        "lineChange": "removed"
                      },
                      {
                        "line": "strlcpy(buf, argv[i], sizeof(buf));\n",
                        "lineNumber": 195,
                        "lineChange": "added"
                      }
                    ]
                  },
                  {
                    "commitURL": "https://github.com/maelswarm/cerver/commit/fc784062a68d3f55af3c08e07c3075093d064f4f?diff=split#diff-a0cb465674c1b01a07d361f25a0ef2b0214b7dfe9412b7777f89add956da10ecL-1",
                    "lines": [
                      {
                        "line": "    memset(sbuff, '\\0', sizeof(sbuff));\n",
                        "lineNumber": 208,
                        "lineChange": "removed"
                      },
                      {
                        "line": "\n",
                        "lineNumber": 209,
                        "lineChange": "removed"
                      },
                      {
                        "line": "    strcat(sbuff, \"HTTP/1.1 200 OK\\r\\n\");\n",
                        "lineNumber": 210,
                        "lineChange": "removed"
                      },
                      {
                        "line": "    strcat(sbuff, \"Content-Length: \");\n",
                        "lineNumber": 211,
                        "lineChange": "removed"
                      },
                      {
                        "line": "    sprintf(sbuff, \"%s%i\", sbuff, fileSize);\n",
                        "lineNumber": 212,
                        "lineChange": "removed"
                      },
                      {
                        "line": "    strcat(sbuff, \"\\r\\nConnection: keep-alive\\r\\n\");\n",
                        "lineNumber": 213,
                        "lineChange": "removed"
                      },
                      {
                        "line": "    strcat(sbuff, \"Keep-Alive: timeout=5, max=20\\r\\n\\r\\n\");\n",
                        "lineNumber": 214,
                        "lineChange": "removed"
                      },
                      {
                        "line": "    strcat(sbuff, fileContent);\n",
                        "lineNumber": 215,
                        "lineChange": "removed"
                      },
                      {
                        "line": "    size_t sbuffSize = sizeof(sbuff);\n",
                        "lineNumber": 212,
                        "lineChange": "added"
                      },
                      {
                        "line": "    memset(sbuff, '\\0', sbuffSize);\n",
                        "lineNumber": 213,
                        "lineChange": "added"
                      },
                      {
                        "line": "\n",
                        "lineNumber": 214,
                        "lineChange": "added"
                      },
                      {
                        "line": "    strlcat(sbuff, \"HTTP/1.1 200 OK\\r\\n\", sbuffSize);\n",
                        "lineNumber": 215,
                        "lineChange": "added"
                      },
                      {
                        "line": "    strlcat(sbuff, \"Content-Length: \", sbuffSize);\n",
                        "lineNumber": 216,
                        "lineChange": "added"
                      },
                      {
                        "line": "    snprintf(sbuff, strlen(sbuff) + 1 + fileSize, \"%s%i\", sbuff, fileSize);\n",
                        "lineNumber": 217,
                        "lineChange": "added"
                      },
                      {
                        "line": "    strlcat(sbuff, \"\\r\\nConnection: keep-alive\\r\\n\", sbuffSize);\n",
                        "lineNumber": 218,
                        "lineChange": "added"
                      },
                      {
                        "line": "    strlcat(sbuff, \"Keep-Alive: timeout=5, max=20\\r\\n\\r\\n\", sbuffSize);\n",
                        "lineNumber": 219,
                        "lineChange": "added"
                      },
                      {
                        "line": "    strlcat(sbuff, fileContent, sbuffSize);\n",
                        "lineNumber": 220,
                        "lineChange": "added"
                      }
                    ]
                  }
                ],
                "exampleCommitDescriptions": [],
                "precision": "very-high",
                "repoDatasetSize": 36,
                "cwe": [
                  "CWE-122"
                ]
              }
            }
          ]
        }
      },
      "results": [
        {
          "ruleId": "cpp/BufferOverflow",
          "ruleIndex": 0,
          "level": "warning",
          "message": {
            "text": "Unsanitized input from a file flows into fscanf, where it is used to store formatted strings. This may result in a buffer overflow vulnerability.",
            "markdown": "Unsanitized input from {0} {1} into {2}, where it is used to store formatted strings. This may result in a buffer overflow vulnerability.",
            "arguments": [
              "[a file](0)",
              "[flows](1),(2)",
              "[fscanf](3)"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "CWE126_Buffer_Overread__CWE129_fscanf_43.cpp",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 1,
                  "endLine": 1,
                  "startColumn": 857,
                  "endColumn": 863
                }
              }
            }
          ],
          "fingerprints": {
            "0": "12f840aa95ef0e1d90846c6bc91e1c52cdd33324536d6ece4320c95afa056dfe",
            "1": "ed27a822.277c621c.7be03776.64353d55.5ef953d3.8f47a30e.1e451703.348c8065.ed27a822.277c621c.7be03776.cc899355.fbee80e3.8f47a30e.30ad82ea.348c8065"
          },
          "codeFlows": [
            {
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "id": 0,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_43.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 878,
                            "endColumn": 882
                          }
                        }
                      }
                    },
                    {
                      "location": {
                        "id": 1,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_43.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 878,
                            "endColumn": 882
                          }
                        }
                      }
                    },
                    {
                      "location": {
                        "id": 2,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_43.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 877,
                            "endColumn": 882
                          }
                        }
                      }
                    },
                    {
                      "location": {
                        "id": 3,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_43.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 857,
                            "endColumn": 863
                          }
                        }
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "properties": {
            "priorityScore": 650,
            "priorityScoreFactors": [
              {
                "label": true,
                "type": "multipleOccurrence"
              },
              {
                "label": true,
                "type": "hotFileSource"
              },
              {
                "label": true,
                "type": "fixExamples"
              }
            ],
            "isAutofixable": false
          }
        },
        {
          "ruleId": "cpp/BufferOverflow",
          "ruleIndex": 0,
          "level": "warning",
          "message": {
            "text": "Unsanitized input from a file flows into fscanf, where it is used to store formatted strings. This may result in a buffer overflow vulnerability.",
            "markdown": "Unsanitized input from {0} {1} into {2}, where it is used to store formatted strings. This may result in a buffer overflow vulnerability.",
            "arguments": [
              "[a file](0)",
              "[flows](1),(2)",
              "[fscanf](3)"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "CWE126_Buffer_Overread__CWE129_fscanf_43.cpp",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 1,
                  "endLine": 1,
                  "startColumn": 2394,
                  "endColumn": 2400
                }
              }
            }
          ],
          "fingerprints": {
            "0": "12f840aa95ef0e1d90846c6bc91e1c52cdd33324536d6ece4320c95afa056dfe",
            "1": "ed27a822.277c621c.7be03776.64353d55.5ef953d3.8f47a30e.1e451703.348c8065.3b4b9534.277c621c.7be03776.cc899355.fbee80e3.8f47a30e.9957b03c.348c8065"
          },
          "codeFlows": [
            {
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "id": 0,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_43.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 2415,
                            "endColumn": 2419
                          }
                        }
                      }
                    },
                    {
                      "location": {
                        "id": 1,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_43.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 2415,
                            "endColumn": 2419
                          }
                        }
                      }
                    },
                    {
                      "location": {
                        "id": 2,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_43.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 2414,
                            "endColumn": 2419
                          }
                        }
                      }
                    },
                    {
                      "location": {
                        "id": 3,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_43.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 2394,
                            "endColumn": 2400
                          }
                        }
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "properties": {
            "priorityScore": 650,
            "priorityScoreFactors": [
              {
                "label": true,
                "type": "multipleOccurrence"
              },
              {
                "label": true,
                "type": "hotFileSource"
              },
              {
                "label": true,
                "type": "fixExamples"
              }
            ],
            "isAutofixable": false
          }
        },
        {
          "ruleId": "cpp/BufferOverflow",
          "ruleIndex": 0,
          "level": "warning",
          "message": {
            "text": "Unsanitized input from a file flows into fscanf, where it is used to store formatted strings. This may result in a buffer overflow vulnerability.",
            "markdown": "Unsanitized input from {0} {1} into {2}, where it is used to store formatted strings. This may result in a buffer overflow vulnerability.",
            "arguments": [
              "[a file](0)",
              "[flows](1),(2)",
              "[fscanf](3)"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "CWE126_Buffer_Overread__CWE129_fscanf_62b.cpp",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 1,
                  "endLine": 1,
                  "startColumn": 854,
                  "endColumn": 860
                }
              }
            }
          ],
          "fingerprints": {
            "0": "8815722ae19e08c023ac5115f80966b355d89d176b87b83d70388ba0eb662c4d",
            "1": "ed27a822.277c621c.7be03776.64353d55.5ef953d3.8f47a30e.1e451703.348c8065.ed27a822.277c621c.7be03776.bf8d7c43.fbee80e3.8f47a30e.30ad82ea.348c8065"
          },
          "codeFlows": [
            {
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "id": 0,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_62b.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 875,
                            "endColumn": 879
                          }
                        }
                      }
                    },
                    {
                      "location": {
                        "id": 1,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_62b.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 875,
                            "endColumn": 879
                          }
                        }
                      }
                    },
                    {
                      "location": {
                        "id": 2,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_62b.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 874,
                            "endColumn": 879
                          }
                        }
                      }
                    },
                    {
                      "location": {
                        "id": 3,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_62b.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 854,
                            "endColumn": 860
                          }
                        }
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "properties": {
            "priorityScore": 650,
            "priorityScoreFactors": [
              {
                "label": true,
                "type": "multipleOccurrence"
              },
              {
                "label": true,
                "type": "hotFileSource"
              },
              {
                "label": true,
                "type": "fixExamples"
              }
            ],
            "isAutofixable": false
          }
        },
        {
          "ruleId": "cpp/BufferOverflow",
          "ruleIndex": 0,
          "level": "warning",
          "message": {
            "text": "Unsanitized input from a file flows into fscanf, where it is used to store formatted strings. This may result in a buffer overflow vulnerability.",
            "markdown": "Unsanitized input from {0} {1} into {2}, where it is used to store formatted strings. This may result in a buffer overflow vulnerability.",
            "arguments": [
              "[a file](0)",
              "[flows](1),(2)",
              "[fscanf](3)"
            ]
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "CWE126_Buffer_Overread__CWE129_fscanf_62b.cpp",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 1,
                  "endLine": 1,
                  "startColumn": 1356,
                  "endColumn": 1362
                }
              }
            }
          ],
          "fingerprints": {
            "0": "8815722ae19e08c023ac5115f80966b355d89d176b87b83d70388ba0eb662c4d",
            "1": "ed27a822.277c621c.7be03776.64353d55.5ef953d3.8f47a30e.1e451703.348c8065.ed27a822.277c621c.7be03776.bf8d7c43.fbee80e3.8f47a30e.30ad82ea.348c8065"
          },
          "codeFlows": [
            {
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "id": 0,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_62b.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 1377,
                            "endColumn": 1381
                          }
                        }
                      }
                    },
                    {
                      "location": {
                        "id": 1,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_62b.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 1377,
                            "endColumn": 1381
                          }
                        }
                      }
                    },
                    {
                      "location": {
                        "id": 2,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_62b.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 1376,
                            "endColumn": 1381
                          }
                        }
                      }
                    },
                    {
                      "location": {
                        "id": 3,
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "CWE126_Buffer_Overread__CWE129_fscanf_62b.cpp",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 1,
                            "endLine": 1,
                            "startColumn": 1356,
                            "endColumn": 1362
                          }
                        }
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "properties": {
            "priorityScore": 650,
            "priorityScoreFactors": [
              {
                "label": true,
                "type": "multipleOccurrence"
              },
              {
                "label": true,
                "type": "hotFileSource"
              },
              {
                "label": true,
                "type": "fixExamples"
              }
            ],
            "isAutofixable": false
          }
        }
      ],
      "properties": {
        "coverage": [
          {
            "isSupported": true,
            "lang": "C++",
            "files": 273,
            "type": "SUPPORTED"
          },
          {
            "isSupported": true,
            "lang": "C",
            "files": 726,
            "type": "SUPPORTED"
          }
        ]
      }
    }
  ]
}
